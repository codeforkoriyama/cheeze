# まち歩き専用ウェブアプリケーション cheeze!!!

自分たちの住む街を再発見する「まち歩きマッピングイベント」で使用したウェブアプリのソースを公開
MySQLなどのデータベースではなく、xmlをデータベースとして利用しているため導入ハードルは低め

## 動作環境

- PHP 5.4以上

※mod_rewrite必須

## 対象デバイス

- Android 4.x+
- iOS 7+

※本ウェブアプリはスマートフォン専用なのでパソコンからは動作しません

## 機能

### フロントエンド

- GPSで現在地を表示(自動更新) ※誤差範囲をブルーの円で視覚化
- データ登録時のピン位置調整
- 写真撮影
- 端末を横にすると他メンバーの登録情報閲覧
- 自分が登録した情報の閲覧・編集・削除
- 現在地情報を一定時間記録

### サーバサイド

- 全メンバーの情報をGoogle Mapにマッピング
- メンバーごとのピン表示
- 一定時間ごとに情報を自動更新


## 技術情報

### フレームワーク

- Slim 2：PHPマイクロフレームワーク

### テンプレートエンジン

- Twig：Slim側出力
- Mustache：JavaScriptのDOM生成用

### JavaScriptライブラリ

- Google Maps API v3
- jQuery

### HTML5 API

- Geo Location API
- File API


### プリプロセッサ

- sass(css)
- TypeScript(JavaScript)

### コンパイラ

- Gulp


## 簡易設定マニュアル

### データ関連

登録データは以下のxmlに格納
ファイルは必ず書き込み権限を付与すること

| ファイル名 | データ内容 |
| --- | --- |
| mapping.xml | ユーザーが登録したデータ |
| root.xml | 一定時間ごとにユーザーの現在地を格納(現在はフロント側での表示等では利用していないため、格納し続けるのみ) |
| backend.xml | 管理画面のユーザー名とパスワードを格納 |

### 管理画面パスワード生成

管理画面のパスワード認証はソルトアンドペッパー方式

パスワードの生成は下記手順

1. パスワード文字列(例：password)をMD5で暗号化
1. 変換した文字列に解除キー(例：password2)を結合
1. 結合した文字列をhashで最暗号化
1. 最終的に生成した文字列を`backend.xml`の`<password>`ノードに記述

**コード例**
```PHP
<?php
$pw = "password";
$md5 = MD5($pw);

$pw2 = "password2".$md5;
$hash = hash('sha256', $pw2);
```
