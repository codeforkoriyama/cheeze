/*******************************************************************************
 * Backend Google Map & ResultList
 *
 * Copyright (c) 2015. Code for KORIYAMA. All Rights Reserved.
 *
 * @author: Nobuyuki Kondo
 * @uri: http://koriyama.io/
 * @version: 1.0
 ******************************************************************************/
///<reference path="../../dts/libs/jquery.d.ts" />
///<reference path="../../dts/libs/googlemap.d.ts"/>
///<reference path="../../dts/libs/custom.d.ts"/>
///<reference path="../../dts/libs/mustache.d.ts"/>
///<reference path="../assets/Cmn.ts"/>
///<reference path="../assets/Events.ts"/>
var BGMapping = (function () {
    function BGMapping() {
        var _this = this;
        this.viewTeam = '';
        this.isData = false;
        this.offset = 0;
        this.marker = [];
        this.mapOption = {
            zoom: 16,
            center: new google.maps.LatLng(37.397983, 140.388412),
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            scrollwheel: true,
            scaleControl: true,
            panControl: true,
            zoomControl: true,
            mapTypeControl: true,
            streetViewControl: true,
            draggable: true
        };
        // チームに関するデータ
        this.teamSetting = [];
        this.teamData = [];
        this.teamMarker = [];
        this.teamRoot = [];
        // テンプレート
        this.template = {
            filterTeam: Cmn.dir + '/mus/filterTeam.mustache',
            fukudashi: Cmn.dir + '/mus/fukidashi.mustache',
            list: Cmn.dir + '/mus/backendList.mustache'
        };
        // ターゲット
        this.target = {
            table: '#resultListBody',
            result: '.resultList'
        };
        var _t = this, div = $('#resultMap').get(0);
        _t.areaMap = new google.maps.Map(div, _t.mapOption);
        // カテゴリーデータの取得
        $.ajax({
            url: Cmn.dir + '/data/category.json',
            dataType: 'json',
            type: 'GET',
            async: false,
            success: function (data) {
                _this.category = data;
            }
        });
        this.markerBounds = new google.maps.LatLngBounds();
        _t.getEntryData();
        // 画像クリック
        $(document).on('click', '.jsClick-ModalImage', function (e) {
            e.preventDefault();
            var file = $(this).data('image'), w = Frame.getBrowserWidth(), h = Frame.getBrowserHeight(), tag = '<img src="' + Cmn.dir + '/uploads/' + file + '" alt="">';
            // TODO: ブラウザサイズに応じて画像表示領域を変更
            $('#modal-contents').html(tag);
            $('#modal').removeClass('hide');
        });
        // モーダルクローズ
        $('#modal-bg').on('click', function () {
            $('#modal').addClass('hide');
            $('#modal-contents').html('');
        });
        // チームフィルタリング
        $(document).on('change', '#filter-team', function () {
            _t.resultList.removeClass('hide');
            var selected = $(this).val();
            if (selected === '0') {
                // すべてを表示
                _t.viewTeam = '';
                for (var i = 0, iLen = _t.marker.length; i < iLen; i++) {
                    var obj = _t.marker[i];
                    obj.setVisible(true);
                }
            }
            else {
                _t.viewTeam = selected;
                // 一致しないチームリストを非表示にする
                _t.resultList.filter(function (index) {
                    var self = $(this), team = self.data('team');
                    if (team !== selected)
                        self.addClass('hide');
                });
                for (var i = 0, iLen = _t.marker.length; i < iLen; i++) {
                    var obj = _t.marker[i], team = obj.team;
                    if (team === selected) {
                        obj.setVisible(true);
                    }
                    else {
                        obj.setVisible(false);
                    }
                }
            }
        });
        // 各チームのトータル件数表示ボタン
        $('#entryTotal-btn').on('click', function (e) {
            e.preventDefault();
            $('#entryTotal-data').toggleClass('show');
        });
        $(document).on('click', '.jsClick-Move', function (e) {
            var self = $(this), lat = self.data('lat'), lng = self.data('lng'), pos = new google.maps.LatLng(lat, lng);
            _t.areaMap.setCenter(pos);
            _t.areaMap.setZoom(18);
        });
        // 1分ごとにデータを取得(1000ms * 60s = 60000ms
        setInterval(function () {
            _t.getEntryData();
        }, 60000);
        // 30秒毎に時間を更新(1000ms * 10s = 10000ms
        setInterval(function () {
            if (_this.isData === false)
                return false;
            for (var i = 0, iLen = _this.resultList.length; i < iLen; i++) {
                var obj = $(_this.resultList[i]), created = obj.find('.created'), __c = created.data('created'), _c = _this.getTimeDiff(__c);
                created.text(_c);
            }
        }, 10000);
        // 5分毎に削除データの取得(1000ms * 60s * 5min = 300000ms
        setInterval(function () {
            $.ajax({
                url: Cmn.dir + '/deleteData',
                dataType: 'json',
                type: 'GET',
                success: function (data) {
                    if (data.status === 'success') {
                        _t.resultList.filter(function (index) {
                            var self = $(this), data_id = String(self.data('id')), isRemove = data.list.indexOf(data_id);
                            if (isRemove > -1) {
                                // 削除データが存在する場合
                                self.remove();
                                _t.resultList.splice(index, 1);
                                _t.marker[index].setMap(null);
                            }
                        });
                    }
                },
                error: function () {
                },
                complete: function () {
                }
            });
        }, 300000); //300000
        // 各チームの登録件数
        setInterval(function () {
            for (var i = 0, iLen = _this.teamSetting.length; i < iLen; i++) {
                var obj = _this.teamSetting[i];
                obj.total = 0;
            }
            for (var n = 0, nLen = _this.teamData.length; n < nLen; n++) {
                var obj1 = _this.teamData[n], isArr = _this.teamSetting.filter(function (elem, index, arr) {
                    return (elem.name === obj1.team);
                });
                isArr[0].total++;
            }
            // トータル件数をセット
            var elem = '';
            for (var j = 0, jLen = _this.teamSetting.length; j < jLen; j++) {
                var obj2 = _this.teamSetting[j];
                elem += '<li>' + obj2.name + ' : ' + obj2.total + '件</li>';
            }
            $('#entryTotal-data').html(elem);
        }, 10000);
    }
    /**
     * 登録されたデータをオフセットで取得
     */
    BGMapping.prototype.getEntryData = function () {
        var _this = this;
        $.ajax({
            url: Cmn.dir + '/allData?offset=' + this.offset,
            dataType: 'json',
            type: 'GET',
            success: function (data) {
                switch (data.status) {
                    case 'success':
                        _this.isData = true;
                        _this.offset = data.count;
                        _this.setTeamList(data.data);
                        break;
                    default:
                        break;
                }
            },
            error: function () {
            },
            complete: function () {
            }
        });
    };
    /**
     * チームデータの格納
     * @param data
     */
    BGMapping.prototype.setTeamList = function (data) {
        var _this = this;
        var elem = '', count = data.length;
        $.get(this.template.filterTeam, function (template) {
            for (var i = 0, iLen = data.length; i < iLen; i++) {
                var obj = data[i], data_id = 0, isArr = _this.teamSetting.filter(function (elem, index, arr) {
                    return (elem.name === obj.team);
                });
                // 該当するチームデータが存在しない場合はチーム情報をセット
                if (isArr.length === 0) {
                    var len = _this.teamSetting.length, 
                    //color_code = Math.floor(Math.random() * 16777215).toString(16),
                    color_code = _this.getRandomColor(_this.teamSetting), team = {
                        name: obj.team,
                        color: color_code,
                        id: len,
                        total: 0
                    };
                    _this.teamSetting.push(team);
                    data_id = len;
                    // <select>タグに挿入
                    elem += Mustache.render(template, obj);
                }
                else {
                    data_id = isArr[0].id;
                }
                obj.team_id = data_id;
                _this.teamData.push(obj);
            }
            $('#filter-team').append(elem);
            _this.setMarker(count);
            _this.setList(count);
        });
    };
    /**
     * 登録データの表示
     * @param count
     */
    BGMapping.prototype.setList = function (count) {
        var _this = this;
        var diff = this.teamData.length - count; // 追加データの個数を返却
        $.get(this.template.list, function (template) {
            var elem = '';
            for (var i = _this.teamData.length - 1; i >= diff; i--) {
                var obj = _this.teamData[i], visible = (_this.viewTeam === obj.team || _this.viewTeam === '') ? '' : ' hide';
                obj.color = _this.teamSetting[obj.team_id].color;
                obj.category = _this.category[obj.cat];
                obj.cls = visible;
                obj.created = _this.getTimeDiff(obj.created_at);
                elem += Mustache.render(template, obj);
            }
            $(_this.target.table).prepend(elem);
            _this.resultList = $(_this.target.result);
        });
    };
    /**
     * マーカーの描写
     * @param count
     */
    BGMapping.prototype.setMarker = function (count) {
        var diff = this.teamData.length - count; // データ個数の返却
        for (var i = diff, iLen = this.teamData.length; i < iLen; i++) {
            var obj = this.teamData[i];
            if (!obj.lat || !obj.lng)
                continue;
            var pos = new google.maps.LatLng(obj.lat, obj.lng), visible = obj.team === this.viewTeam || this.viewTeam === '', 
            //context = Mustache.render(template, obj),
            color = this.teamSetting[obj.team_id].color, icon = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_bubble_text_small&chld=bb|" + obj.data_id + "|" + color + "|000000"), marker = new google.maps.Marker({
                position: pos,
                icon: icon,
                map: this.areaMap,
                team: obj.team,
                visible: visible
            });
            this.marker.push(marker);
            this.markerBounds.extend(pos);
        }
        this.areaMap.fitBounds(this.markerBounds);
        //$.get(this.template.fukudashi, (template)=> {
        //
        //});
    };
    /**
     * ランダムカラーの生成
     * @param obj
     * @returns {string}
     */
    BGMapping.prototype.getRandomColor = function (obj) {
        if (obj === void 0) { obj = []; }
        var color = _generait();
        /// TODO:色の重複除去処理
        return color;
        function _generait() {
            var h = (Math.random() * 0xFFFFFF | 0).toString(16);
            return ('000000' + h).slice(-6);
        }
    };
    BGMapping.prototype.getTimeDiff = function (times) {
        if (times === '')
            return '';
        var now = new Date().getTime(), setTime = times.replace(/-/g, '/'), timestamp = new Date(setTime).getTime(), diffTime = now - timestamp, timeData = diffTime / 1000 >> 0; // 1000ミリ秒で割る
        if (timeData < 60) {
            return timeData + '秒前';
        }
        // 60秒で割る
        timeData = timeData / 60 >> 0;
        if (timeData < 60) {
            return timeData + '分前';
        }
        // 60分で割る
        timeData = timeData / 60 >> 0;
        if (timeData < 24) {
            return timeData + '時間前';
        }
        // 24時間で割る
        timeData = timeData / 24 >> 0;
        if (timeData < 365) {
            return times;
        }
        //
        //// 365日で割る
        //timeData = timeData / 365 >> 0;
        //return timeData + '年以上前';
    };
    return BGMapping;
})();
new BGMapping();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsdWdpbnMvQmFja2VuZE1hcHBpbmcudHMiXSwibmFtZXMiOlsiQkdNYXBwaW5nIiwiQkdNYXBwaW5nLmNvbnN0cnVjdG9yIiwiQkdNYXBwaW5nLmdldEVudHJ5RGF0YSIsIkJHTWFwcGluZy5zZXRUZWFtTGlzdCIsIkJHTWFwcGluZy5zZXRMaXN0IiwiQkdNYXBwaW5nLnNldE1hcmtlciIsIkJHTWFwcGluZy5nZXRSYW5kb21Db2xvciIsIkJHTWFwcGluZy5nZXRSYW5kb21Db2xvci5fZ2VuZXJhaXQiLCJCR01hcHBpbmcuZ2V0VGltZURpZmYiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7OztnRkFRZ0Y7QUFDOUUsa0RBQWtEO0FBQ2xELG9EQUFvRDtBQUNwRCxpREFBaUQ7QUFDakQsbURBQW1EO0FBQ25ELHVDQUF1QztBQUN2QywwQ0FBMEM7QUFFNUMsSUFBTSxTQUFTO0lBOENiQSxTQTlDSUEsU0FBU0E7UUFBZkMsaUJBNlpDQTtRQTVaU0EsYUFBUUEsR0FBVUEsRUFBRUEsQ0FBQ0E7UUFDckJBLFdBQU1BLEdBQVdBLEtBQUtBLENBQUNBO1FBRXZCQSxXQUFNQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUtsQkEsV0FBTUEsR0FBT0EsRUFBRUEsQ0FBQ0E7UUFDaEJBLGNBQVNBLEdBQUdBO1lBQ2xCQSxJQUFJQSxFQUFlQSxFQUFFQTtZQUNyQkEsTUFBTUEsRUFBYUEsSUFBSUEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsU0FBU0EsRUFBRUEsVUFBVUEsQ0FBQ0E7WUFDaEVBLFNBQVNBLEVBQVVBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLE9BQU9BO1lBQ2hEQSxXQUFXQSxFQUFRQSxJQUFJQTtZQUN2QkEsWUFBWUEsRUFBT0EsSUFBSUE7WUFDdkJBLFVBQVVBLEVBQVNBLElBQUlBO1lBQ3ZCQSxXQUFXQSxFQUFRQSxJQUFJQTtZQUN2QkEsY0FBY0EsRUFBS0EsSUFBSUE7WUFDdkJBLGlCQUFpQkEsRUFBRUEsSUFB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QSxDQUFDQSxDQUFDQTtRQUNMQSxDQUFDQSxFQUFFQSxNQUFNQSxDQUFDQSxFQUFFQSxRQUFRQTtRQUVwQkEsQUFDQUEsWUFEWUE7UUFDWkEsV0FBV0EsQ0FBQ0E7WUFFVkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsSUFBSUEsR0FBR0EsS0FBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7Z0JBQzlEQSxJQUFJQSxHQUFHQSxHQUFHQSxLQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDOUJBLEdBQUdBLENBQUNBLEtBQUtBLEdBQUdBLENBQUNBLENBQUNBO1lBQ2hCQSxDQUFDQTtZQUdEQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxJQUFJQSxHQUFHQSxLQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtnQkFDM0RBLElBQUlBLElBQUlBLEdBQUdBLEtBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLEVBQ3pCQSxLQUFLQSxHQUFHQSxLQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFDQSxJQUFJQSxFQUFFQSxLQUFLQSxFQUFFQSxHQUFHQTtvQkFDakRBLE1BQU1BLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLEtBQUtBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUFBO2dCQUNsQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBRUhBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO1lBQ25CQSxDQUFDQTtZQUVEQSxBQUNBQSxhQURhQTtnQkFDVEEsSUFBSUEsR0FBR0EsRUFBRUEs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Q0EsV0FBV0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0E7Z0JBQy9DQSxJQUFJQSxJQUFJQSxRQUFRQSxDQUFDQSxNQUFNQSxDQUFDQSxRQUFRQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUN6Q0EsQ0FBQ0E7WUFFREEsQ0FBQ0EsQ0FBQ0EsS0FBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFFbkNBLEtBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLEtBQUlBLENBQUNBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO1FBQzFDQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNMQSxDQUFDQTtJQUVESjs7O09BR0dBO0lBQ0hBLDZCQUFTQSxHQUFUQSxVQUFVQSxLQUFLQTtRQUNiSyxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxHQUFHQSxLQUFLQSxFQUFJQSxXQUFXQTtRQUV0REEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsRUFBRUEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7WUFDOURBLElBQUlBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRTNCQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQTtnQkFBQ0EsUUFBUUEsQ0FBQ0E7WUFFbkNBLElBQUlBLEdBQUdBLEdBQUdBLElBQUlBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEVBQUVBLEdBQUdBLENBQUNBLEdB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QSxHQUFHQSxRQUFRQSxHQUFHQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUM5QkEsRUFBRUEsQ0FBQUEsQ0FBQ0EsUUFBUUEsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7WUFDaEJBLE1BQU1BLENBQUNBLFFBQVFBLEdBQUdBLElBQUlBLENBQUNBO1FBQ3pCQSxDQUFDQTtRQUVEQSxBQUNBQSxTQURTQTtRQUNUQSxRQUFRQSxHQUFHQSxRQUFRQSxHQUFHQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUM5QkEsRUFBRUEsQ0FBQUEsQ0FBQ0EsUUFBUUEsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7WUFDaEJBLE1BQU1BLENBQUNBLFFBQVFBLEdBQUdBLEtBQUtBLENBQUNBO1FBQzFCQSxDQUFDQTtRQUtEQSxBQUNBQSxVQURVQTtRQUNWQSxRQUFRQSxHQUFHQSxRQUFRQSxHQUFHQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUM5QkEsRUFBRUEsQ0FBQUEsQ0FBQ0EsUUFBUUEsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7WUFDakJBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBO1FBRWZBLENBQUNBO1FBQ0RBLEVBQUVBO1FBQ0ZBLFlBQVlBO1FBQ1pBLGlDQUFpQ0E7UUFDakNBLDJCQUEyQkE7SUFDN0JBLENBQUNBO0lBQ0hSLGdCQUFDQTtBQUFEQSxDQTdaQSxBQTZaQ0EsSUFBQTtBQUVELElBQUksU0FBUyxFQUFFLENBQUMiLCJmaWxlIjoicGx1Z2lucy9CYWNrZW5kTWFwcGluZy5qcyIsInNvdXJjZVJvb3QiOiIuLi9fd3MvdHlwZXNjcmlwdC8iLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogQmFja2VuZCBHb29nbGUgTWFwICYgUmVzdWx0TGlzdFxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNS4gQ29kZSBmb3IgS09SSVlBTUEuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogQGF1dGhvcjogTm9idXl1a2kgS29uZG9cbiAqIEB1cmk6IGh0dHA6Ly9rb3JpeWFtYS5pby9cbiAqIEB2ZXJzaW9uOiAxLjBcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gIC8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2R0cy9saWJzL2pxdWVyeS5kLnRzXCIgLz5cbiAgLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vZHRzL2xpYnMvZ29vZ2xlbWFwLmQudHNcIi8+XG4gIC8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2R0cy9saWJzL2N1c3RvbS5kLnRzXCIvPlxuICAvLy88cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9kdHMvbGlicy9tdXN0YWNoZS5kLnRzXCIvPlxuICAvLy88cmVmZXJlbmNlIHBhdGg9XCIuLi9hc3NldHMvQ21uLnRzXCIvPlxuICAvLy88cmVmZXJlbmNlIHBhdGg9XCIuLi9hc3NldHMvRXZlbnRzLnRzXCIvPlxuXG5jbGFzcyBCR01hcHBpbmcge1xuICBwcml2YXRlIHZpZXdUZWFtOnN0cmluZyA9ICcnO1xuICBwcml2YXRlIGlzRGF0YTpib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBvZmZzZXQ6bnVtYmVyID0gMDtcblxuICAvLyDjg57jg4Pjg5fplqLpgKNcbiAgcHJpdmF0ZSBhcmVhTWFwOmFueTtcbiAgcHJpdmF0ZSBtYXJrZXJCb3VuZHM6YW55O1xuICBwcml2YXRlIG1hcmtlcjphbnkgPSBbXTtcbiAgcHJpdmF0ZSBtYXBPcHRpb24gPSB7XG4gICAgem9vbSAgICAgICAgICAgICA6IDE2LFxuICAgIGNlbnRlciAgICAgICAgICAgOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDM3LjM5Nzk4MywgMTQwLjM4ODQxMiksICAgIC8vIOmDoeWxsemnhVxuICAgIG1hcFR5cGVJZCAgICAgICAgOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICBzY3JvbGx3aGVlbCAgICAgIDogdHJ1ZSxcbiAgICBzY2FsZUNvbnRyb2wgICAgIDogdHJ1ZSxcbiAgICBwYW5Db250cm9sICAgICAgIDogdHJ1ZSxcbiAgICB6b29tQ29udHJvbCAgICAgIDogdHJ1ZSxcbiAgICBtYXBUeXBlQ29udHJvbCAgIDogdHJ1ZSxcbiAgICBzdHJlZXRWaWV3Q29udHJvbDogdHJ1ZSxcbiAgICBkcmFnZ2FibGUgICAgICAgIDogdHJ1ZVxuICB9O1xuXG4gIC8vIOODgeODvOODoOOBq+mWouOBmeOCi+ODh+ODvOOCv1xuICBwcml2YXRlIHRlYW1TZXR0aW5nOmFueSA9IFtdO1xuICBwcml2YXRlIHRlYW1EYXRhOmFueSA9IFtdO1xuICBwcml2YXRlIHRlYW1NYXJrZXI6YW55ID0gW107XG4gIHByaXZhdGUgdGVhbVJvb3Q6YW55ID0gW107XG5cbiAgLy8g44OG44Oz44OX44Os44O844OIXG4gIHByaXZhdGUgdGVtcGxhdGUgPSB7XG4gICAgZmlsdGVyVGVhbTogQ21uLmRpciArICcvbXVzL2ZpbHRlclRlYW0ubXVzdGFjaGUnLFxuICAgIGZ1a3VkYXNoaSA6IENtbi5kaXIgKyAnL211cy9mdWtpZGFzaGkubXVzdGFjaGUnLFxuICAgIGxpc3Q6IENtbi5kaXIgKyAnL211cy9iYWNrZW5kTGlzdC5tdXN0YWNoZSdcbiAgfTtcblxuICBwcml2YXRlIGNhdGVnb3J5OmFueTtcblxuICBwcml2YXRlIHJlc3VsdExpc3Q6YW55O1xuXG4gIC8vIOOCv+ODvOOCsuODg+ODiFxuICBwcml2YXRlIHRhcmdldCA9IHtcbiAgICB0YWJsZTogJyNyZXN1bHRMaXN0Qm9keScsXG4gICAgcmVzdWx0OiAnLnJlc3VsdExpc3QnXG4gIH07XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdmFyIF90ID0gdGhpcyxcbiAgICAgIGRpdiA9ICQoJyNyZXN1bHRNYXAnKS5nZXQoMCk7XG4gICAgX3QuYXJlYU1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZGl2LCBfdC5tYXBPcHRpb24pO1xuXG4gICAgLy8g44Kr44OG44K044Oq44O844OH44O844K/44Gu5Y+W5b6XXG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogQ21uLmRpciArICcvZGF0YS9jYXRlZ29yeS5qc29uJyxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICB0eXBlOiAnR0VUJyxcbiAgICAgIGFzeW5jOiBmYWxzZSxcbiAgICAgIHN1Y2Nlc3M6IChkYXRhKT0+e1xuICAgICAgICB0aGlzLmNhdGVnb3J5ID0gZGF0YTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMubWFya2VyQm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xuXG4gICAgX3QuZ2V0RW50cnlEYXRhKCk7XG5cblxuICAgIC8vIOeUu+WDj+OCr+ODquODg+OCr1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuanNDbGljay1Nb2RhbEltYWdlJywgZnVuY3Rpb24oZSl7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgZmlsZSA9ICQodGhpcykuZGF0YSgnaW1hZ2UnKSxcbiAgICAgICAgdyA9IEZyYW1lLmdldEJyb3dzZXJXaWR0aCgpLFxuICAgICAgICBoID0gRnJhbWUuZ2V0QnJvd3NlckhlaWdodCgpLFxuICAgICAgICB0YWcgPSAnPGltZyBzcmM9XCInICsgQ21uLmRpciArICcvdXBsb2Fkcy8nICsgZmlsZSArICdcIiBhbHQ9XCJcIj4nO1xuXG4gICAgICAvLyBUT0RPOiDjg5bjg6njgqbjgrbjgrXjgqTjgrrjgavlv5zjgZjjgabnlLvlg4/ooajnpLrpoJjln5/jgpLlpInmm7RcbiAgICAgICQoJyNtb2RhbC1jb250ZW50cycpLmh0bWwodGFnKTtcbiAgICAgICQoJyNtb2RhbCcpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgfSk7XG5cbiAgICAvLyDjg6Ljg7zjg4Djg6vjgq/jg63jg7zjgrpcbiAgICAkKCcjbW9kYWwtYmcnKS5vbignY2xpY2snLCAoKT0+e1xuICAgICAgJCgnI21vZGFsJykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICQoJyNtb2RhbC1jb250ZW50cycpLmh0bWwoJycpO1xuICAgIH0pO1xuXG4gICAgLy8g44OB44O844Og44OV44Kj44Or44K/44Oq44Oz44KwXG4gICAgJChkb2N1bWVudCkub24oJ2NoYW5nZScsICcjZmlsdGVyLXRlYW0nLCBmdW5jdGlvbigpe1xuICAgICAgX3QucmVzdWx0TGlzdC5yZW1vdmVDbGFzcygnaGlkZScpO1xuXG4gICAgICB2YXIgc2VsZWN0ZWQgPSAkKHRoaXMpLnZhbCgpO1xuXG4gICAgICBpZihzZWxlY3RlZCA9PT0gJzAnKXtcbiAgICAgICAgLy8g44GZ44G544Gm44KS6KGo56S6XG4gICAgICAgIF90LnZpZXdUZWFtID0gJyc7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlMZW4gPSBfdC5tYXJrZXIubGVuZ3RoOyBpIDwgaUxlbjsgaSsrKSB7XG4gICAgICAgICAgdmFyIG9iaiA9IF90Lm1hcmtlcltpXTtcblxuICAgICAgICAgIG9iai5zZXRWaXNpYmxlKHRydWUpO1xuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgX3Qudmlld1RlYW0gPSBzZWxlY3RlZDtcblxuICAgICAgICAvLyDkuIDoh7TjgZfjgarjgYTjg4Hjg7zjg6Djg6rjgrnjg4jjgpLpnZ7ooajnpLrjgavjgZnjgotcbiAgICAgICAgX3QucmVzdWx0TGlzdC5maWx0ZXIoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAgIHZhciBzZWxmID0gJCh0aGlzKSxcbiAgICAgICAgICAgIHRlYW0gPSBzZWxmLmRhdGEoJ3RlYW0nKTtcblxuICAgICAgICAgIGlmKHRlYW0gIT09IHNlbGVjdGVkKSBzZWxmLmFkZENsYXNzKCdoaWRlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIOS4gOiHtOOBl+OBquOBhOODgeODvOODoOOBruODlOODs+OCkumdnuihqOekuuOBq+OBmeOCi1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaUxlbiA9IF90Lm1hcmtlci5sZW5ndGg7IGkgPCBpTGVuOyBpKyspIHtcbiAgICAgICAgICB2YXIgb2JqID0gX3QubWFya2VyW2ldLFxuICAgICAgICAgICAgdGVhbSA9IG9iai50ZWFtO1xuXG4gICAgICAgICAgaWYodGVhbSA9PT0gc2VsZWN0ZWQpe1xuICAgICAgICAgICAgb2JqLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBvYmouc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDlkITjg4Hjg7zjg6Djga7jg4jjg7zjgr/jg6vku7bmlbDooajnpLrjg5zjgr/jg7NcbiAgICAkKCcjZW50cnlUb3RhbC1idG4nKS5vbignY2xpY2snLCAoZSk9PntcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgJCgnI2VudHJ5VG90YWwtZGF0YScpLnRvZ2dsZUNsYXNzKCdzaG93Jyk7XG4gICAgfSk7XG5cbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmpzQ2xpY2stTW92ZScsIGZ1bmN0aW9uKGUpe1xuICAgICAgdmFyIHNlbGYgPSAkKHRoaXMpLFxuICAgICAgICBsYXQgPSBzZWxmLmRhdGEoJ2xhdCcpLFxuICAgICAgICBsbmcgPSBzZWxmLmRhdGEoJ2xuZycpLFxuICAgICAgICBwb3MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcblxuICAgICAgX3QuYXJlYU1hcC5zZXRDZW50ZXIocG9zKTtcbiAgICAgIF90LmFyZWFNYXAuc2V0Wm9vbSgxOCk7XG4gICAgfSk7XG5cbiAgICAvLyAx5YiG44GU44Go44Gr44OH44O844K/44KS5Y+W5b6XKDEwMDBtcyAqIDYwcyA9IDYwMDAwbXNcbiAgICBzZXRJbnRlcnZhbCgoKT0+IHtcbiAgICAgIF90LmdldEVudHJ5RGF0YSgpO1xuICAgIH0sIDYwMDAwKTtcblxuICAgIC8vIDMw56eS5q+O44Gr5pmC6ZaT44KS5pu05pawKDEwMDBtcyAqIDEwcyA9IDEwMDAwbXNcbiAgICBzZXRJbnRlcnZhbCgoKT0+e1xuICAgICAgaWYodGhpcy5pc0RhdGEgPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7XG4gICAgICBmb3IgKHZhciBpID0gMCwgaUxlbiA9IHRoaXMucmVzdWx0TGlzdC5sZW5ndGg7IGkgPCBpTGVuOyBpKyspIHtcbiAgICAgICAgdmFyIG9iaiA9ICQodGhpcy5yZXN1bHRMaXN0W2ldKSxcbiAgICAgICAgICBjcmVhdGVkID0gb2JqLmZpbmQoJy5jcmVhdGVkJyksXG4gICAgICAgICAgX19jID0gY3JlYXRlZC5kYXRhKCdjcmVhdGVkJyksXG4gICAgICAgICAgX2MgPSB0aGlzLmdldFRpbWVEaWZmKF9fYyk7XG5cbiAgICAgICAgY3JlYXRlZC50ZXh0KF9jKTtcbiAgICAgIH1cbiAgICB9LCAxMDAwMCk7XG5cbiAgICAvLyA15YiG5q+O44Gr5YmK6Zmk44OH44O844K/44Gu5Y+W5b6XKDEwMDBtcyAqIDYwcyAqIDVtaW4gPSAzMDAwMDBtc1xuICAgIHNldEludGVydmFsKCgpPT57XG4gICAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6IENtbi5kaXIgKyAnL2RlbGV0ZURhdGEnLFxuICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgc3VjY2VzczogKGRhdGEpPT57XG4gICAgICAgICAgaWYoZGF0YS5zdGF0dXMgPT09ICdzdWNjZXNzJyl7XG4gICAgICAgICAgICBfdC5yZXN1bHRMaXN0LmZpbHRlcihmdW5jdGlvbihpbmRleCl7XG4gICAgICAgICAgICAgIHZhciBzZWxmID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICBkYXRhX2lkID0gU3RyaW5nKHNlbGYuZGF0YSgnaWQnKSksXG4gICAgICAgICAgICAgICAgaXNSZW1vdmUgPSBkYXRhLmxpc3QuaW5kZXhPZihkYXRhX2lkKTtcblxuICAgICAgICAgICAgICBpZihpc1JlbW92ZSA+IC0xKXtcbiAgICAgICAgICAgICAgICAvLyDliYrpmaTjg4fjg7zjgr/jgYzlrZjlnKjjgZnjgovloLTlkIhcbiAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIF90LnJlc3VsdExpc3Quc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBfdC5tYXJrZXJbaW5kZXhdLnNldE1hcChudWxsKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogKCk9Pnt9LFxuICAgICAgICBjb21wbGV0ZTogKCk9Pnt9XG4gICAgICB9KTtcbiAgICB9LCAzMDAwMDApOyAvLzMwMDAwMFxuXG4gICAgLy8g5ZCE44OB44O844Og44Gu55m76Yyy5Lu25pWwXG4gICAgc2V0SW50ZXJ2YWwoKCk9PntcbiAgICAgIC8vIOS4gOW6puODiOODvOOCv+ODq+S7tuaVsOOCkuWJiumZpFxuICAgICAgZm9yICh2YXIgaSA9IDAsIGlMZW4gPSB0aGlzLnRlYW1TZXR0aW5nLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xuICAgICAgICB2YXIgb2JqID0gdGhpcy50ZWFtU2V0dGluZ1tpXTtcbiAgICAgICAgb2JqLnRvdGFsID0gMDtcbiAgICAgIH1cblxuICAgICAgLy8g5Lu25pWw44KS6KiI566XXG4gICAgICBmb3IgKHZhciBuID0gMCwgbkxlbiA9IHRoaXMudGVhbURhdGEubGVuZ3RoOyBuIDwgbkxlbjsgbisrKSB7XG4gICAgICAgIHZhciBvYmoxID0gdGhpcy50ZWFtRGF0YVtuXSxcbiAgICAgICAgICBpc0FyciA9IHRoaXMudGVhbVNldHRpbmcuZmlsdGVyKChlbGVtLCBpbmRleCwgYXJyKT0+e1xuICAgICAgICAgIHJldHVybiAoZWxlbS5uYW1lID09PSBvYmoxLnRlYW0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlzQXJyWzBdLnRvdGFsKys7XG4gICAgICB9XG5cbiAgICAgIC8vIOODiOODvOOCv+ODq+S7tuaVsOOCkuOCu+ODg+ODiFxuICAgICAgdmFyIGVsZW0gPSAnJztcbiAgICAgIGZvciAodmFyIGogPSAwLCBqTGVuID0gdGhpcy50ZWFtU2V0dGluZy5sZW5ndGg7IGogPCBqTGVuOyBqKyspIHtcbiAgICAgICAgdmFyIG9iajIgPSB0aGlzLnRlYW1TZXR0aW5nW2pdO1xuXG4gICAgICAgIGVsZW0gKz0gJzxsaT4nICsgb2JqMi5uYW1lICsgJyA6ICcgKyBvYmoyLnRvdGFsICsgJ+S7tjwvbGk+JztcbiAgICAgIH1cblxuICAgICAgJCgnI2VudHJ5VG90YWwtZGF0YScpLmh0bWwoZWxlbSk7XG4gICAgfSwgMTAwMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIOeZu+mMsuOBleOCjOOBn+ODh+ODvOOCv+OCkuOCquODleOCu+ODg+ODiOOBp+WPluW+l1xuICAgKi9cbiAgZ2V0RW50cnlEYXRhKCkge1xuICAgICQuYWpheCh7XG4gICAgICB1cmwgICAgIDogQ21uLmRpciArICcvYWxsRGF0YT9vZmZzZXQ9JyArIHRoaXMub2Zmc2V0LFxuICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgIHR5cGUgICAgOiAnR0VUJyxcbiAgICAgIHN1Y2Nlc3MgOiAoZGF0YSk9PiB7XG4gICAgICAgIHN3aXRjaCAoZGF0YS5zdGF0dXMpIHtcbiAgICAgICAgICBjYXNlICdzdWNjZXNzJzpcbiAgICAgICAgICAgIHRoaXMuaXNEYXRhID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMub2Zmc2V0ID0gZGF0YS5jb3VudDtcbiAgICAgICAgICAgIHRoaXMuc2V0VGVhbUxpc3QoZGF0YS5kYXRhKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGVycm9yICAgOiAoKT0+IHtcbiAgICAgIH0sXG4gICAgICBjb21wbGV0ZTogKCk9PiB7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog44OB44O844Og44OH44O844K/44Gu5qC857SNXG4gICAqIEBwYXJhbSBkYXRhXG4gICAqL1xuICBzZXRUZWFtTGlzdChkYXRhKSB7XG4gICAgdmFyIGVsZW0gPSAnJyxcbiAgICAgIGNvdW50ID0gZGF0YS5sZW5ndGg7XG5cbiAgICAkLmdldCh0aGlzLnRlbXBsYXRlLmZpbHRlclRlYW0sICh0ZW1wbGF0ZSk9PiB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgaUxlbiA9IGRhdGEubGVuZ3RoOyBpIDwgaUxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBvYmogPSBkYXRhW2ldLFxuICAgICAgICAgIGRhdGFfaWQgPSAwLFxuICAgICAgICAgIGlzQXJyID0gdGhpcy50ZWFtU2V0dGluZy5maWx0ZXIoKGVsZW0sIGluZGV4LCBhcnIpPT4geyAgICAvLyDphY3liJflhoXjgavjg4fjg7zjgr/jgYzlrZjlnKjjgZnjgovjgYvjg4Hjgqfjg4Pjgq9cbiAgICAgICAgICAgIHJldHVybiAoZWxlbS5uYW1lID09PSBvYmoudGVhbSlcbiAgICAgICAgICB9KTtcblxuICAgICAgICAvLyDoqbLlvZPjgZnjgovjg4Hjg7zjg6Djg4fjg7zjgr/jgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjga/jg4Hjg7zjg6Dmg4XloLHjgpLjgrvjg4Pjg4hcbiAgICAgICAgaWYgKGlzQXJyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHZhciBsZW4gPSB0aGlzLnRlYW1TZXR0aW5nLmxlbmd0aCxcbiAgICAgICAgICAgIC8vY29sb3JfY29kZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNiksXG4gICAgICAgICAgICBjb2xvcl9jb2RlID0gdGhpcy5nZXRSYW5kb21Db2xvcih0aGlzLnRlYW1TZXR0aW5nKSxcbiAgICAgICAgICAgIHRlYW0gPSB7XG4gICAgICAgICAgICAgIG5hbWUgOiBvYmoudGVhbSxcbiAgICAgICAgICAgICAgY29sb3I6IGNvbG9yX2NvZGUsXG4gICAgICAgICAgICAgIGlkICAgOiBsZW4sXG4gICAgICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgdGhpcy50ZWFtU2V0dGluZy5wdXNoKHRlYW0pO1xuICAgICAgICAgIGRhdGFfaWQgPSBsZW47XG5cbiAgICAgICAgICAvLyA8c2VsZWN0PuOCv+OCsOOBq+aMv+WFpVxuICAgICAgICAgIGVsZW0gKz0gTXVzdGFjaGUucmVuZGVyKHRlbXBsYXRlLCBvYmopO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRhdGFfaWQgPSBpc0FyclswXS5pZDtcbiAgICAgICAgfVxuXG4gICAgICAgIG9iai50ZWFtX2lkID0gZGF0YV9pZDtcblxuICAgICAgICB0aGlzLnRlYW1EYXRhLnB1c2gob2JqKTtcbiAgICAgIH1cblxuICAgICAgJCgnI2ZpbHRlci10ZWFtJykuYXBwZW5kKGVsZW0pO1xuICAgICAgdGhpcy5zZXRNYXJrZXIoY291bnQpO1xuICAgICAgdGhpcy5zZXRMaXN0KGNvdW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnmbvpjLLjg4fjg7zjgr/jga7ooajnpLpcbiAgICogQHBhcmFtIGNvdW50XG4gICAqL1xuICBzZXRMaXN0KGNvdW50KXtcbiAgICB2YXIgZGlmZiA9IHRoaXMudGVhbURhdGEubGVuZ3RoIC0gY291bnQ7ICAgIC8vIOi/veWKoOODh+ODvOOCv+OBruWAi+aVsOOCkui/lOWNtFxuXG4gICAgJC5nZXQodGhpcy50ZW1wbGF0ZS5saXN0LCAodGVtcGxhdGUpPT57XG4gICAgICB2YXIgZWxlbSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudGVhbURhdGEubGVuZ3RoIC0gMTsgaSA+PSBkaWZmOyBpLS0pIHtcbiAgICAgICAgdmFyIG9iaiA9IHRoaXMudGVhbURhdGFbaV0sXG4gICAgICAgICAgdmlzaWJsZSA9ICh0aGlzLnZpZXdUZWFtID09PSBvYmoudGVhbSB8fCB0aGlzLnZpZXdUZWFtID09PSAnJykgPyAnJyA6ICcgaGlkZSc7XG5cbiAgICAgICAgb2JqLmNvbG9yID0gdGhpcy50ZWFtU2V0dGluZ1tvYmoudGVhbV9pZF0uY29sb3I7XG4gICAgICAgIG9iai5jYXRlZ29yeSA9IHRoaXMuY2F0ZWdvcnlbb2JqLmNhdF07XG4gICAgICAgIG9iai5jbHMgPSB2aXNpYmxlO1xuICAgICAgICBvYmouY3JlYXRlZCA9IHRoaXMuZ2V0VGltZURpZmYob2JqLmNyZWF0ZWRfYXQpO1xuICAgICAgICBlbGVtICs9IE11c3RhY2hlLnJlbmRlcih0ZW1wbGF0ZSwgb2JqKTtcbiAgICAgIH1cblxuICAgICAgJCh0aGlzLnRhcmdldC50YWJsZSkucHJlcGVuZChlbGVtKTtcblxuICAgICAgdGhpcy5yZXN1bHRMaXN0ID0gJCh0aGlzLnRhcmdldC5yZXN1bHQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOODnuODvOOCq+ODvOOBruaPj+WGmVxuICAgKiBAcGFyYW0gY291bnRcbiAgICovXG4gIHNldE1hcmtlcihjb3VudCkge1xuICAgIHZhciBkaWZmID0gdGhpcy50ZWFtRGF0YS5sZW5ndGggLSBjb3VudDsgICAvLyDjg4fjg7zjgr/lgIvmlbDjga7ov5TljbRcblxuICAgIGZvciAodmFyIGkgPSBkaWZmLCBpTGVuID0gdGhpcy50ZWFtRGF0YS5sZW5ndGg7IGkgPCBpTGVuOyBpKyspIHtcbiAgICAgIHZhciBvYmogPSB0aGlzLnRlYW1EYXRhW2ldO1xuXG4gICAgICBpZiAoIW9iai5sYXQgfHwgIW9iai5sbmcpIGNvbnRpbnVlO1xuXG4gICAgICB2YXIgcG9zID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhvYmoubGF0LCBvYmoubG5nKSxcbiAgICAgICAgdmlzaWJsZSA9IG9iai50ZWFtID09PSB0aGlzLnZpZXdUZWFtIHx8IHRoaXMudmlld1RlYW0gPT09ICcnLFxuICAgICAgICAvL2NvbnRleHQgPSBNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGUsIG9iaiksXG4gICAgICAgIGNvbG9yID0gdGhpcy50ZWFtU2V0dGluZ1tvYmoudGVhbV9pZF0uY29sb3IsXG4gICAgICAgIGljb24gPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VySW1hZ2UoXCJodHRwOi8vY2hhcnQuYXBpcy5nb29nbGUuY29tL2NoYXJ0P2Noc3Q9ZF9idWJibGVfdGV4dF9zbWFsbCZjaGxkPWJifFwiKyBvYmouZGF0YV9pZCArXCJ8XCIrY29sb3IrXCJ8MDAwMDAwXCIpLFxuICAgICAgICBtYXJrZXI6YW55ID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgICAgcG9zaXRpb246IHBvcyxcbiAgICAgICAgICBpY29uOiBpY29uLFxuICAgICAgICAgIG1hcCAgICAgOiB0aGlzLmFyZWFNYXAsXG4gICAgICAgICAgdGVhbSAgICA6IG9iai50ZWFtLFxuICAgICAgICAgIHZpc2libGU6IHZpc2libGVcbiAgICAgICAgfSk7XG5cbiAgICAgIHRoaXMubWFya2VyLnB1c2gobWFya2VyKTtcbiAgICAgIHRoaXMubWFya2VyQm91bmRzLmV4dGVuZChwb3MpO1xuICAgIH1cblxuICAgIHRoaXMuYXJlYU1hcC5maXRCb3VuZHModGhpcy5tYXJrZXJCb3VuZHMpO1xuXG4gICAgLy8kLmdldCh0aGlzLnRlbXBsYXRlLmZ1a3VkYXNoaSwgKHRlbXBsYXRlKT0+IHtcbiAgICAvL1xuICAgIC8vfSk7XG4gIH1cblxuXG5cbiAgLyoqXG4gICAqIOODqeODs+ODgOODoOOCq+ODqeODvOOBrueUn+aIkFxuICAgKiBAcGFyYW0gb2JqXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuICBnZXRSYW5kb21Db2xvcihvYmogPSBbXSl7XG4gICAgdmFyIGNvbG9yID0gX2dlbmVyYWl0KCk7XG5cbiAgICAvLy8gVE9ETzroibLjga7ph43opIfpmaTljrvlh6bnkIZcblxuICAgIHJldHVybiBjb2xvcjtcblxuICAgIGZ1bmN0aW9uIF9nZW5lcmFpdCgpe1xuICAgICAgdmFyIGggPSAoTWF0aC5yYW5kb20oKSAqIDB4RkZGRkZGfDApLnRvU3RyaW5nKDE2KTtcbiAgICAgIHJldHVybiAoJzAwMDAwMCcgKyBoKS5zbGljZSgtNik7XG4gICAgfVxuICB9XG5cblxuICBnZXRUaW1lRGlmZih0aW1lcyl7XG4gICAgaWYodGltZXMgPT09ICcnKSByZXR1cm4gJyc7XG4gICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgc2V0VGltZSA9IHRpbWVzLnJlcGxhY2UoLy0vZywgJy8nKSwgICAvLyBpT1Plr77lv5zjgILjgb7jgZXjgYvjg4/jgqTjg5Xjg7PjgrXjg53jg7zjg4jjgZfjgabjgarjgYTjgajjgYvjg7vjg7vjg7tcbiAgICAgIHRpbWVzdGFtcCA9IG5ldyBEYXRlKHNldFRpbWUpLmdldFRpbWUoKSxcbiAgICAgIGRpZmZUaW1lID0gbm93IC0gdGltZXN0YW1wLFxuICAgICAgdGltZURhdGEgPSBkaWZmVGltZSAvIDEwMDAgPj4gMDsgICAvLyAxMDAw44Of44Oq56eS44Gn5Ymy44KLXG5cbiAgICBpZih0aW1lRGF0YSA8IDYwKXtcbiAgICAgIHJldHVybiB0aW1lRGF0YSArICfnp5LliY0nO1xuICAgIH1cblxuICAgIC8vIDYw56eS44Gn5Ymy44KLXG4gICAgdGltZURhdGEgPSB0aW1lRGF0YSAvIDYwID4+IDA7XG4gICAgaWYodGltZURhdGEgPCA2MCl7XG4gICAgICByZXR1cm4gdGltZURhdGEgKyAn5YiG5YmNJztcbiAgICB9XG5cbiAgICAvLyA2MOWIhuOBp+WJsuOCi1xuICAgIHRpbWVEYXRhID0gdGltZURhdGEgLyA2MCA+PiAwO1xuICAgIGlmKHRpbWVEYXRhIDwgMjQpe1xuICAgICAgcmV0dXJuIHRpbWVEYXRhICsgJ+aZgumWk+WJjSc7XG4gICAgfVxuXG5cblxuXG4gICAgLy8gMjTmmYLplpPjgaflibLjgotcbiAgICB0aW1lRGF0YSA9IHRpbWVEYXRhIC8gMjQgPj4gMDtcbiAgICBpZih0aW1lRGF0YSA8IDM2NSl7XG4gICAgICByZXR1cm4gdGltZXM7XG4gICAgICAvL3JldHVybiB0aW1lRGF0YSArICfml6XliY0nO1xuICAgIH1cbiAgICAvL1xuICAgIC8vLy8gMzY15pel44Gn5Ymy44KLXG4gICAgLy90aW1lRGF0YSA9IHRpbWVEYXRhIC8gMzY1ID4+IDA7XG4gICAgLy9yZXR1cm4gdGltZURhdGEgKyAn5bm05Lul5LiK5YmNJztcbiAgfVxufVxuXG5uZXcgQkdNYXBwaW5nKCk7XG4iXX0=